<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.cdnfonts.com/css/old-london" rel="stylesheet">
    <title>🐟</title>
</head>

<body>
    <div id="wrapper">
        <!-- 固定的nav导航栏 -->
        <nav id="mainNav">
            <ol>
                <li>主页 </li>
                <li>笔记 </li>
                <li>阅读 </li>
                <!-- <li>书签 </li> -->
                <li>相册 </li>
            </ol>
            <div class="container">
                <label for="switch">
                    <input type="checkbox" id="switch">
                    <div class="toggle-wrapper">
                        <div class="day-night">
                        </div>
                        <div class="tree-left">
                            <div class="tree"></div>
                            <div class="trunk">
                                <div class="branch"></div>
                                <div class="branch"></div>
                            </div>
                        </div>
                        <div class="tree-right">
                            <div class="tree-back">
                                <div class="trunk"></div>
                            </div>
                            <div class="tree-front">
                                <div class="trunk"></div>
                            </div>
                        </div>
                        <div class="moon"></div>
                        <div class="stars">
                            <div class="star big-star">
                                <div class="vertical"></div>
                                <div class="horizontal"></div>
                            </div>
                            <div class="star small-star">
                                <div class="vertical"></div>
                                <div class="horizontal"></div>
                            </div>
                        </div>
                        <div class="sun"></div>
                        <div class="hills">
                            <div class="hill-left"></div>
                            <div class="hill-right"></div>
                        </div>
                    </div>
                </label>
            </div>

            <div id="gitLogo"></div>
        </nav>
        <!-- 容器节点，盛装各个展示页 -->
        <div id="container"></div>
    </div>
</body>
<script>
    // 入口的script，主要负责配合nav栏展示各界面
    // 子页面的script会直接以script节点形式载入，注意命名冲突
    const mainContainer = document.getElementById('container'); // 获取容器节点
    const mainNav = document.getElementById('mainNav').children[0].children;
    const toGit = document.getElementById('gitLogo');

    // nav栏滑动收放用的参数
    // 由于子页面的滑动阻尼效果,暂时没有实现
    // const scrollContainer = document.getElementById('wrapper');
    // let lastScrollTop = 0;
    // const header = document.getElementById('mainNav');

    // 为简化对子页面模块中需要执行的JS的处理,直接将其写在一个html中
    // 但innerHTML中的script不会执行，写一个函数来分离script标签中的内容
    function sliceStr(tempStr) {
        if (typeof tempStr === 'string') {
            let htmlStr = tempStr;
            let scriptStr = '';
            let start = tempStr.indexOf('<script>');
            if (start > 0) {
                htmlStr = tempStr.slice(0, start);
                scriptStr = tempStr.slice(start + 8, tempStr.length - 9);
            }
            return {
                htmlStr,
                scriptStr
            }
        }
    }

    window.addEventListener('load', () => {
        // 为nav每个子条目添加点击事件以显示对应子页面

        for (let i = 0; i < 4; i++) {
            mainNav[i].addEventListener('click', () => {
                let strObj = sliceStr(window.temp[i]);
                container.innerHTML = strObj.htmlStr;
                eval(strObj.scriptStr);
            })
        }
        mainNav[0].click(); // 默认展示home页内容

        // 为gitHub的logo添加点击跳转
        toGit.addEventListener('click', () => {
            window.open("https://github.com/v-yui");
        })
    })

    // 上滑收起nav栏,下滑放出nav栏
    // 监听 #wrapper 的 scroll 事件
    // 由于子页面的滑动阻尼效果,暂时没有实现
    // scrollContainer.addEventListener('scroll', function () {
    //     let scrollTop = scrollContainer.scrollTop;
    //     console.log(`Current ScrollTop: ${scrollTop}`); // 调试输出

    //     if (scrollTop > lastScrollTop) {
    //         // 向下滚动，隐藏标题栏
    //         header.style.transform = 'translateY(-100px)';
    //     } else {
    //         // 向上滚动，显示标题栏
    //         header.style.transform = 'translateY(0)';
    //     }

    //     lastScrollTop = scrollTop;
    // });

    // 切换白天黑夜
    document.addEventListener('DOMContentLoaded', function () {
        var checkbox = document.querySelector('input[type="checkbox"]');

        checkbox.addEventListener('change', function () {
            document.documentElement.classList.toggle('switch');
        });
    });
</script>

</html>